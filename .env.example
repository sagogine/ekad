# ============================================
# Traceback Configuration Template
# ============================================
# Copy this file to .env and fill in your values
# For multi-tenant deployments, create separate .env files per tenant
# (e.g., .env.claims, .env.retail) and reference them in docker-compose

# ============================================
# REQUIRED: Secrets
# ============================================
# Google API Key (Required for LLM and embeddings)
GOOGLE_API_KEY=your_google_api_key_here

# ============================================
# REQUIRED: Tenant Configuration
# ============================================
# Business areas (comma-separated list of tenant identifiers)
BUSINESS_AREAS=claims,retail

# Source configuration (per-business-area)
# Format: area:source(key=value, key2=value2),area2:source2(key=value)
# Examples:
#   - Confluence: claims:confluence(space=CLM,labels=incident)
#   - Code: claims:code(source=gitlab,project_path=org/repo,languages=python|java|sql)
#   - OpenMetadata: claims:openmetadata(service=datahub)
SOURCES_CONFIG=\
  claims:confluence(space=CLM,labels=incident),\
  claims:code(source=gitlab,project_path=org/claims-repo,languages=python|java|sql),\
  claims:openmetadata(service=datahub),\
  retail:confluence(space=RTL),\
  retail:code(source=gitlab,project_path=org/retail-repo,languages=python|sql)

# Retriever overrides (optional)
# Format: area:source=retriever1|retriever2
# Defaults: gitlab→code, openmetadata→lineage, confluence/firestore→docs
RETRIEVER_OVERRIDES=claims:openmetadata=lineage,claims:code=code

# ============================================
# OPTIONAL: Service Endpoints & Credentials
# ============================================
# Confluence (required if using confluence source)
CONFLUENCE_URL=https://your-domain.atlassian.net
CONFLUENCE_USERNAME=bot@company.com
CONFLUENCE_API_TOKEN=your_confluence_api_token

# Firestore (required if using firestore source)
GOOGLE_CLOUD_PROJECT=your-gcp-project-id
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# GitLab (required if using gitlab or code source)
GITLAB_URL=https://gitlab.com
GITLAB_TOKEN=your_gitlab_personal_access_token

# OpenMetadata (required if using openmetadata source)
OPENMETADATA_URL=https://openmetadata.company.com/api/v1
OPENMETADATA_TOKEN=your_openmetadata_api_token

# Qdrant (optional, defaults shown)
QDRANT_HOST=localhost
QDRANT_PORT=6333
QDRANT_API_KEY=

# LangSmith (optional, for observability)
LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=
LANGCHAIN_PROJECT=traceback

# ============================================
# OPTIONAL: Infrastructure Settings
# ============================================
# These have sensible defaults and rarely need to be changed

# LLM Configuration
LLM_MODEL=gemini-2.5-flash-lite
LLM_TEMPERATURE=0.1
LLM_MAX_TOKENS=8192

# Embedding Configuration
EMBEDDING_MODEL=models/text-embedding-004
EMBEDDING_DIMENSION=768

# RAG Configuration
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
TOP_K_RETRIEVAL=10
RERANK_TOP_K=5

# Cache Configuration
CACHE_TTL_SECONDS=3600
ENABLE_SEMANTIC_CACHE=true

# Ingestion Configuration
INGESTION_BATCH_SIZE=100
SYNC_INTERVAL_HOURS=1

# Application Configuration
APP_NAME=Traceback
APP_VERSION=0.1.0
DEBUG=true
LOG_LEVEL=INFO

# ============================================
# OPTIONAL: Secrets Manager Configuration
# ============================================
# Secrets Provider: 'none' (env vars only) or 'gcp' (GCP Secret Manager)
# When set to 'gcp', secrets will be fetched from GCP Secret Manager
# if not found in environment variables
SECRETS_PROVIDER=none

# Secrets path prefix (optional)
# Example: 'traceback/prod' would look for 'traceback/prod/google-api-key' in Secret Manager
SECRETS_PATH_PREFIX=


# ============================================
# OPTIONAL: Code Graph Configuration (Neo4j + CodeQL)
# ============================================
# Code graph is an optional augmentation layer for RAG
# Not required for every business area - enable per area in SOURCES_CONFIG

# Neo4j Configuration (required if using code graph)
NEO4J_URL=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password

# CodeQL Configuration (optional)
CODEQL_ENABLED=false
CODEQL_DATABASE_PATH=/data/codeql-databases
CODEQL_STORAGE_TYPE=local
CODEQL_GCS_BUCKET=
CODEQL_ANALYSIS_FREQUENCY=manual
CODEQL_SCHEDULED_INTERVAL_HOURS=24

# To enable code graph for a business area, add to SOURCES_CONFIG:
# claims:codeql(enabled=true,repos=org/repo1|org/repo2)
